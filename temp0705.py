import numpy as np
import matplotlib.pyplot as plt
from matplotlib.patches import PathPatch
from matplotlib.path import Path
import sys
sys.stdout.reconfigure(encoding='utf-8')  # 改變輸出的
def layer_categorize(bezier_array):
    """
    將貝茲曲線數組分類成閉合輪廓
    """
    if not bezier_array:
        return []
    
    # 初始化每個貝茲曲線為獨立的層
    layers = []
    for item in bezier_array:
        layers.append([item])
    
    # 持續合併直到無法再合併
    while True:
        merged = False
        i = 0
        while i < len(layers):
            j = i + 1
            while j < len(layers):
                # 檢查是否可以連接 (頭對尾)
                if np.allclose(layers[i][0][0], layers[j][-1][-1], atol=1e-10):
                    # 將 layers[i] 移到 layers[j] 的尾部
                    layers[j].extend(layers[i])
                    layers.pop(i)
                    merged = True
                    break
                # 檢查是否可以連接 (尾對頭)
                elif np.allclose(layers[i][-1][-1], layers[j][0][0], atol=1e-10):
                    # 將 layers[j] 移到 layers[i] 的尾部
                    layers[i].extend(layers[j])
                    layers.pop(j)
                    merged = True
                    break
                j += 1
            if merged:
                break
            i += 1
        
        if not merged:
            break
    
    # 檢查並移除不是閉合輪廓的層
    closed_layers = []
    for layer in layers:
        if len(layer) > 0:
            # 檢查是否形成閉合輪廓
            if np.allclose(layer[0][0], layer[-1][-1], atol=1e-10):
                closed_layers.append(layer)
            else:
                print(f"警告: 發現非閉合輪廓，起點: {layer[0][0]}, 終點: {layer[-1][-1]}")
    
    return closed_layers

def bezier_to_points(bezier_curves, num_points=100):
    """
    將貝茲曲線轉換為點集合
    """
    all_points = []
    
    for curve in bezier_curves:
        if len(curve) == 4:  # 三次貝茲曲線
            t = np.linspace(0, 1, num_points)
            points = np.array([(1-t)**3 * curve[0][0] + 3*(1-t)**2*t * curve[1][0] + 
                              3*(1-t)*t**2 * curve[2][0] + t**3 * curve[3][0],
                              (1-t)**3 * curve[0][1] + 3*(1-t)**2*t * curve[1][1] + 
                              3*(1-t)*t**2 * curve[2][1] + t**3 * curve[3][1]]).T
        elif len(curve) == 3:  # 二次貝茲曲線
            t = np.linspace(0, 1, num_points)
            points = np.array([(1-t)**2 * curve[0][0] + 2*(1-t)*t * curve[1][0] + t**2 * curve[2][0],
                              (1-t)**2 * curve[0][1] + 2*(1-t)*t * curve[1][1] + t**2 * curve[2][1]]).T
        else:  # 直線
            points = np.array([curve[0], curve[-1]])
        
        all_points.extend(points)
    
    return np.array(all_points)

def point_in_polygon(point, polygon_points):
    """
    使用射線法判斷點是否在多邊形內部
    """
    x, y = point
    n = len(polygon_points)
    inside = False
    
    p1x, p1y = polygon_points[0]
    for i in range(1, n + 1):
        p2x, p2y = polygon_points[i % n]
        if y > min(p1y, p2y):
            if y <= max(p1y, p2y):
                if x <= max(p1x, p2x):
                    if p1y != p2y:
                        xinters = (y - p1y) * (p2x - p1x) / (p2y - p1y) + p1x
                    if p1x == p2x or x <= xinters:
                        inside = not inside
        p1x, p1y = p2x, p2y
    
    return inside

def calculate_polygon_area(points):
    """
    計算多邊形面積 (使用鞋帶公式)
    """
    n = len(points)
    area = 0
    for i in range(n):
        j = (i + 1) % n
        area += points[i][0] * points[j][1]
        area -= points[j][0] * points[i][1]
    return abs(area) / 2

def categorize_contours(closed_contours):
    """
    分類輪廓的內外子母關係
    """
    if not closed_contours:
        return []
    
    # 轉換為點集合並計算面積
    contour_data = []
    for i, contour in enumerate(closed_contours):
        points = bezier_to_points(contour)
        area = calculate_polygon_area(points)
        contour_data.append({
            'index': i,
            'contour': contour,
            'points': points,
            'area': area,
            'children': [],
            'parent': None
        })
    
    # 按面積由大到小排序
    contour_data.sort(key=lambda x: x['area'], reverse=True)
    
    # 建立父子關係
    for i in range(len(contour_data)):
        for j in range(i + 1, len(contour_data)):
            parent = contour_data[i]
            child = contour_data[j]
            
            # 檢查小輪廓是否在大輪廓內部
            # 取小輪廓的幾個測試點
            test_points = child['points'][::len(child['points'])//5]  # 取5個測試點
            
            inside_count = 0
            for point in test_points:
                if point_in_polygon(point, parent['points']):
                    inside_count += 1
            
            # 如果大部分測試點都在內部，則認為是子輪廓
            if inside_count >= len(test_points) // 2:
                # 檢查是否已經有更近的父輪廓
                current_parent = child['parent']
                if current_parent is None or parent['area'] < current_parent['area']:
                    # 如果之前有父輪廓，從舊父輪廓的children中移除
                    if current_parent is not None:
                        current_parent['children'].remove(child)
                    
                    # 設置新的父子關係
                    child['parent'] = parent
                    parent['children'].append(child)
    
    # 建立層級結構
    def build_hierarchy(contour_info, level=0):
        result = {
            'level': level,
            'contour': contour_info['contour'],
            'area': contour_info['area'],
            'is_hole': level % 2 == 1,  # 奇數層級為洞
            'children': []
        }
        
        for child in contour_info['children']:
            result['children'].append(build_hierarchy(child, level + 1))
        
        return result
    
    # 找出根輪廓（沒有父輪廓的輪廓）
    root_contours = [c for c in contour_data if c['parent'] is None]
    
    # 建立完整的層級結構
    hierarchy = []
    for root in root_contours:
        hierarchy.append(build_hierarchy(root))
    
    return hierarchy

def visualize_contours(hierarchy, figsize=(12, 8)):
    """
    視覺化輪廓層級關係
    """
    fig, (ax1, ax2) = plt.subplots(1, 2, figsize=figsize)
    
    # 顏色映射
    colors = ['red', 'blue', 'green', 'orange', 'purple', 'brown', 'pink', 'gray']
    
    def plot_contour(ax, contour_info, color_idx=0, show_direction=False):
        points = bezier_to_points(contour_info['contour'])
        
        # 繪製輪廓
        if contour_info['is_hole']:
            ax.plot(points[:, 0], points[:, 1], 
                   color=colors[color_idx % len(colors)], 
                   linewidth=2, linestyle='--', 
                   label=f"洞 (面積: {contour_info['area']:.2f})")
        else:
            ax.plot(points[:, 0], points[:, 1], 
                   color=colors[color_idx % len(colors)], 
                   linewidth=2,
                   label=f"外輪廓 (面積: {contour_info['area']:.2f})")
        
        # 標記起始點
        ax.plot(points[0, 0], points[0, 1], 'ko', markersize=8)
        ax.text(points[0, 0], points[0, 1], f'  L{contour_info["level"]}', 
                fontsize=10, ha='left')
        
        # 繪製方向箭頭
        if show_direction and len(points) > 10:
            mid_idx = len(points) // 2
            dx = points[mid_idx + 1, 0] - points[mid_idx - 1, 0]
            dy = points[mid_idx + 1, 1] - points[mid_idx - 1, 1]
            ax.arrow(points[mid_idx, 0], points[mid_idx, 1], 
                    dx * 0.1, dy * 0.1, 
                    head_width=0.05, head_length=0.05, 
                    fc=colors[color_idx % len(colors)], 
                    ec=colors[color_idx % len(colors)])
        
        # 遞歸繪製子輪廓
        for child in contour_info['children']:
            plot_contour(ax, child, color_idx + 1, show_direction)
    
    # 左圖：基本輪廓
    ax1.set_title('輪廓分層結果')
    for i, root in enumerate(hierarchy):
        plot_contour(ax1, root, i)
    ax1.set_aspect('equal')
    ax1.grid(True, alpha=0.3)
    ax1.legend()
    
    # 右圖：帶方向的輪廓
    ax2.set_title('輪廓方向與層級')
    for i, root in enumerate(hierarchy):
        plot_contour(ax2, root, i, show_direction=True)
    ax2.set_aspect('equal')
    ax2.grid(True, alpha=0.3)
    
    plt.tight_layout()
    plt.show()

def print_hierarchy(hierarchy, indent=0):
    """
    印出層級結構
    """
    for contour_info in hierarchy:
        prefix = "  " * indent
        contour_type = "洞" if contour_info['is_hole'] else "外輪廓"
        print(f"{prefix}層級 {contour_info['level']}: {contour_type} (面積: {contour_info['area']:.2f})")
        
        if contour_info['children']:
            print_hierarchy(contour_info['children'], indent + 1)

# 測試範例
def create_test_bezier():
    """
    創建測試用的貝茲曲線數據
    """
    
    
    # 合併所有貝茲曲線並打亂順序
    all_beziers = [[(250, 849), (250.28623911884594, 852.379847193419), (256.9973620849704, 861.7805762767313), (262, 861)], [(262, 861), (259.58098542982685, 857.1002222060414), (256.1805246990866, 850.9986114342287), (250, 849)], [(361, 845), (349.7293196161062, 847.3915645731335), (334.6035808167943, 852.6285828470141), (327, 861)], [(327, 861), (338.946133070244, 861.5957669339144), (352.95138479978016, 843.0563414010583), (365, 851)], [(365, 851), (358.7612004449211, 853.4675929727006), (352.59247396971256, 857.2025741528678), (348, 861)], [(348, 861), (358.8471195970757, 862.6539290715165), (368.0466419314618, 846.6104409505543), (378, 853)], [(378, 853), (371.6037777789617, 855.7764566966587), (369.8483400847583, 855.6517200989215), (362, 861)], [(362, 861), (370.9685402894753, 861.9207599634257), (377.00444427313187, 855.3615442103882), (379, 861)], [(379, 861), (377.5238055163997, 857.1999903976296), (375.8948103504921, 857.2051217316206), (382, 853)], [(382, 853), (391.1065414029651, 855.1037124580658), (395.6420730071695, 862.4011512451351), (406, 861)], [(406, 861), (393.661800847399, 853.9296064373561), (380.7907619505043, 846.2978910535254), (361, 845)], [(594, 837), (592.6681322144592, 843.2124092188592), (586.2502366265979, 854.3776046913832), (584, 861)], [(584, 861), (590.6817247170057, 857.4541060889037), (600.2564835938414, 840.0962177103407), (594, 837)], [(243, 836), (256.8608641737075, 847.8787144252695), (273.24506183755216, 852.3370265635994), (286, 861)], [(286, 861), (275.47474266542247, 846.6004232609904), (259.50802235256225, 842.7341411984896), (243, 836)], [(373, 822), (368.6217135491832, 825.1790519548258), (359.87138174340856, 822.2427837055084), (360, 828)], [(360, 828), (367.78059416952937, 827.3781696723074), (377.55268898567164, 825.9271140850313), (385, 828)], [(385, 828), (403.87407513167443, 838.4477851244299), (429.4115099601819, 855.9573686530424), (453, 861)], [(453, 861), (422.0712884483867, 846.0771781998137), (405.82893157061545, 832.686721757825), (373, 822)], [(53, 806), (50.04352206771233, 820.2936351945709), (47.12025287996603, 842.2918916858713), (48, 861)], [(48, 861), (51.98950305263018, 847.9701774424069), (55.56205900499868, 821.470731884871), (53, 806)], [(663, 781), (643.3321815936291, 801.613444824166), (618.5932922309244, 809.3291867200486), (598, 824)], [(598, 824), (622.0288191932376, 814.5284548204321), (655.8352928930075, 799.7100760436141), (663, 781)], [(726, 765), (723.4015573809573, 790.7638617809113), (724.5959691546519, 826.3847263872675), (722, 857)], [(722, 857), (725.308530905546, 863.4372081509749), (725.6593835329569, 855.2581846914768), (732, 861)], [(732, 861), (727.9332763261235, 852.9682475075784), (729.5482045152111, 842.9484178216381), (726, 836)], [(726, 836), (725.1276924469609, 812.6459597043522), (731.3591684333501, 784.2459472260298), (726, 765)], [(694, 654), (693.54241686592, 659.2090835325863), (690.2688858160725, 661.6022191494061), (691, 668)], [(691, 668), (693.1687066961152, 664.8651411978209), (695.5869716341488, 657.671384277931), (694, 654)], [(78, 486), (59.50065176352233, 548.5974766667802), (34.66239002727627, 603.3916702961565), (11, 661)], [(11, 661), (8.847514673822241, 678.8833479567336), (-2.0329997292676394, 690.3137367448126), (0, 710)], [(0, 710), (20.60928086188074, 638.8315522303513), (46.63372001187356, 586.2951115305357), (70, 525)], [(70, 525), (70.71764879820279, 511.0576807822929), (84.29021497522591, 495.8539966256182), (78, 486)], [(807, 418), (805.4331766509981, 424.3172983965058), (812.1671833850052, 417.58329166249985), (807, 418)], [(747, 386), (738.8093965044693, 426.92986698334454), (742.0350960849477, 469.29213070785386), (740, 510)], [(740, 510), (722.6493527279648, 577.1541465443299), (697.7129338472208, 642.867996196212), (685, 713)], [(685, 713), (709.8258080488921, 623.9627310334695), (733.2436462435463, 555.6143105076891), (751, 471)], [(751, 471), (751.8062758730622, 443.9899040139395), (757.0377217006067, 419.8008063806336), (757, 391)], [(757, 391), (748.5677865190505, 412.7465130389436), (752.7829835332179, 452.36795820049906), (745, 476)], [(745, 476), (742.6562116939201, 446.04397694167375), (748.1070577866, 411.40657548595425), (747, 386)], [(133, 327), (125.21364654894568, 349.06266428746466), (130.52605657292816, 376.0372681959542), (129, 401)], [(129, 401), (134.6008607435349, 411.22766977917564), (133.5703179729458, 429.9449081696814), (146, 438)], [(146, 438), (138.72494399090655, 422.3984842398311), (133.41946149203892, 405.27170523100597), (131, 390)], [(131, 390), (131.33926921561303, 369.7134170793896), (134.53888743275192, 345.3949937682457), (133, 327)], [(237, 225), (223.66283228582245, 248.5819864446268), (220.91488762826862, 280.5333285333184), (210, 302)], [(210, 302), (207.06574372380206, 334.04599763813957), (194.3958665887396, 355.81458763900815), (198, 390)], [(198, 390), (201.15326010620575, 361.6288412387551), (208.64545045314048, 333.7908981061578), (212, 307)], [(212, 307), (221.72891142293454, 280.3153638472063), (231.37247028044672, 251.19230849219394), (237, 225)], [(364, 95), (344.7659631613057, 99.01735505076473), (328.69185466105, 110.25142371553484), (307, 123)], [(307, 123), (278.10293964624935, 152.77853125818046), (258.5816089220956, 177.8498427442675), (243, 211)], [(243, 211), (262.0676226353009, 184.67516307418703), (284.1604211871874, 148.58161054591133), (309, 126)], [(309, 126), (329.60128836592435, 114.9473421039251), (354.03704550988095, 91.59060294190503), (384, 100)], [(384, 100), (382.8312731486376, 93.63534049908108), (370.9239525314167, 95.2983796425812), (364, 95)], [(413, 47), (372.5916260496185, 42.817821992908854), (348.0426173996469, 61.46274752995862), (311, 66)], [(311, 66), (296.44336482284086, 74.09387965408376), (276.9436862456568, 84.51726136322347), (265, 94)], [(265, 94), (263.31953195319517, 98.2124879154582), (271.42054205420555, 92.37747108044137), (269, 97)], [(269, 97), (250.16706785273627, 106.85177517665986), (228.9725296105586, 115.93410808784563), (215, 134)], [(215, 134), (204.3776234303785, 134.87932830071153), (196.10037379761874, 130.48155181016858), (185, 132)], [(185, 132), (172.3874878214152, 143.2079886811805), (148.5743641046536, 139.39469608754513), (135, 156)], [(135, 156), (134.34776356600318, 161.66666666666666), (135.1579835604336, 167.3333333333334), (139, 173)], [(139, 173), (118.49274866971216, 202.2428009693085), (107.85347767698543, 222.96615697042506), (100, 254)], [(100, 254), (95.72060503679921, 275.48042999698157), (94.90934667851835, 301.8453141336406), (96, 323)], [(96, 323), (84.86333886860434, 331.6789485786025), (75.88797219758561, 336.23281013246424), (67, 344)], [(67, 344), (80.52998116600747, 340.82348029868194), (82.13010079511255, 334.56334837188376), (95, 329)], [(95, 329), (89.26927685200238, 428.8027754325618), (82.4098791454448, 528.0578781994026), (77, 620)], [(77, 620), (61.0279651427822, 699.413918320884), (22.08031194300959, 783.3486522579367), (1, 861)], [(1, 861), (29.721765559908636, 784.9921316045953), (55.79534247240654, 715.9469267629639), (79, 629)], [(79, 629), (84.95077647565388, 528.5921084637902), (95.91156695321163, 431.5611763812292), (96, 327)], [(96, 327), (111.39469129086802, 316.41443297275964), (127.23835540827329, 304.55763805852797), (141, 294)], [(141, 294), (151.30619126613976, 278.5778181756533), (148.18865498696823, 260.49055136941826), (156, 246)], [(156, 246), (141.7523484751108, 255.13654020399443), (150.1412625506308, 279.9817002372278), (137, 293)], [(137, 293), (128.95292094807277, 298.74018038400175), (119.3200546783412, 307.0950524669821), (110, 311)], [(110, 311), (143.98655619278995, 253.1399263198852), (177.04544366358203, 186.20726116896557), (220, 131)], [(220, 131), (250.9928681283643, 106.1024397579709), (299.8533733887396, 85.38706390721507), (332, 67)], [(332, 67), (352.04527361774944, 66.0736976194215), (371.37289007467194, 69.01568818738791), (389, 70)], [(389, 70), (378.0519510804982, 61.67818794768078), (357.1046858260233, 66.30383180044196), (344, 63)], [(344, 63), (361.17037770609704, 53.07131679188242), (376.13006564365674, 53.40057407587052), (393, 50)], [(393, 50), (414.33333333333314, 50.177150185066075), (435.66666666666686, 49.169193650904326), (457, 52)], [(457, 52), (447.5205747595069, 58.659161704302406), (433.67088038953517, 59.550482807766215), (427, 70)], [(427, 70), (460.84514496059325, 45.26508280707481), (510.697895699624, 49.707927774268605), (547, 68)], [(547, 68), (609.6767959866858, 95.69291739885507), (655.406302309752, 141.67802096431635), (690, 207)], [(690, 207), (685.266305294573, 220.30002169186582), (675.9577301032793, 235.28521069678243), (660, 239)], [(660, 239), (650.266533721471, 231.27708233949016), (632.6986192223296, 221.34344264758283), (619, 219)], [(619, 219), (623.7927295427737, 226.44903859787092), (649.3463901594852, 232.16976134113696), (656, 240)], [(656, 240), (645.567113190519, 245.2390084129349), (635.6006996659994, 252.06443335528957), (626, 255)], [(626, 255), (616.0685314065134, 228.19476184362682), (608.5840611655425, 196.95767979869052), (600, 174)], [(600, 174), (618.4831639311785, 182.00203800857912), (635.5736133715197, 195.2545634354638), (653, 205)], [(653, 205), (659.5797332476536, 210.1070711652428), (672.5415322819168, 224.66129874845592), (676, 230)], [(676, 230), (649.3201722284002, 185.61271422986468), (583.6050940026765, 168.30167304895275), (562, 127)], [(562, 127), (531.3348963994673, 111.91171521324334), (504.95808255246607, 84.71183422870185), (464, 85)], [(464, 85), (506.9929840665066, 94.99152645854184), (566.287428521463, 125.02552058817463), (591, 164)], [(591, 164), (605.4796507402062, 190.30644486069548), (610.8861565216624, 229.70612628644903), (624, 256)], [(624, 256), (621.3090056693799, 265.22409190919865), (611.0647552874482, 266.7819906663728), (608, 275)], [(608, 275), (606.6104726215665, 282.9999999999997), (605.3206554019434, 291.0000000000002), (606, 299)], [(606, 299), (615.5596392024694, 315.06540946301607), (627.5912913632643, 330.0646188599849), (639, 341)], [(639, 341), (640.9399324825039, 361.2380049153273), (646.7158663018814, 378.67649909239043), (648, 401)], [(648, 401), (651.5763210034548, 412.515675990112), (655.6174515161606, 417.92514536082166), (658, 428)], [(658, 428), (643.6972935728822, 421.5586299199359), (630.2678826302249, 402.1462999777526), (623, 391)], [(623, 391), (621.2141073642208, 372.4199131863189), (631.9194461074356, 348.67271535770584), (624, 335)], [(624, 335), (623.248783267821, 358.85886391363914), (618.32302012929, 381.8733401467976), (620, 405)], [(620, 405), (605.1814658620319, 432.2749191395779), (600.7533981132964, 472.0634738059278), (573, 495)], [(573, 495), (575.9115803436504, 485.4430424144373), (585.1596844276145, 474.7694180980233), (586, 461)], [(586, 461), (567.3070713161782, 472.0269179462048), (563.1035657772546, 493.65994642560173), (544, 510)], [(544, 510), (532.8793623111799, 515.7759722958706), (525.1610378292203, 525.0355288156306), (510, 530)], [(510, 530), (513.3278997308258, 524.3372750185771), (518.0486011268071, 520.0363670626122), (524, 512)], [(524, 512), (525.4098743207654, 508.39633963396324), (526.8307497416406, 505.0832083208321), (522, 506)], [(522, 506), (514.2807090010025, 520.1816061227255), (500.20565031338526, 534.9979281740656), (488, 539)], [(488, 539), (532.7364220450652, 460.18814504706035), (554.0723375555349, 382.6974321906999), (549, 287)], [(549, 287), (540.3531254142547, 224.91272107744172), (514.608364291445, 112.70108226029073), (447, 110)], [(447, 110), (498.2767456137588, 114.13083419397955), (506.5627703663239, 170.77650217527474), (530, 207)], [(530, 207), (545.388052030917, 265.18218048503724), (554.7425221959818, 335.6346019690049), (537, 395)], [(537, 395), (524.0846210106663, 380.6423206632172), (506.5950665894509, 372.9563117677315), (492, 365)], [(492, 365), (484.3327490524671, 336.2877445175573), (486.13237072269584, 301.75427701083953), (485, 267)], [(485, 267), (476.79320220747843, 293.29329070576466), (485.7672529643529, 330.5703587491736), (485, 361)], [(485, 361), (471.12742614324475, 355.0224268856641), (462.6671970444391, 354.9612942052526), (447, 352)], [(447, 352), (437.120762167046, 321.4925389681673), (450.0987260382634, 283.3825055227442), (444, 254)], [(444, 254), (441.92633824149004, 276.11146592940867), (431.82649308922424, 293.46365172045586), (430, 314)], [(430, 314), (415.7474351760509, 336.81236633630107), (413.7995483805147, 372.44600958479685), (397, 390)], [(397, 390), (396.7647850644332, 363.4137922029591), (396.448857481354, 341.45872015572274), (400, 316)], [(400, 316), (409.70927578993314, 276.49420371941255), (421.1392437918964, 229.3833899033922), (432, 192)], [(432, 192), (412.8568007151835, 232.18670734278754), (406.1079326106927, 280.6248704102165), (394, 334)], [(394, 334), (389.7443674162156, 382.4600120233118), (394.5944723538168, 428.104589253372), (412, 468)], [(412, 468), (385.92388182295304, 447.4525555183281), (371.3726403654467, 425.5343486547908), (348, 397)], [(348, 397), (342.40858781868786, 379.17316401245137), (332.68275943859925, 356.7141803957842), (329, 341)], [(329, 341), (329.0013811165874, 370.12857523243554), (348.58880407339956, 395.9705704782222), (346, 420)], [(346, 420), (334.3783236369217, 409.18239125142577), (325.6664476314622, 390.6395266611443), (319, 373)], [(319, 373), (317.3201219369997, 339.6342316789549), (310.7480267971549, 309.6087869451553), (313, 275)], [(313, 275), (305.9600789774325, 283.0045754970053), (308.6051086605702, 309.0707700087884), (302, 324)], [(302, 324), (299.1193901579606, 323.88060984203923), (295.4537805737467, 324.5462194262534), (294, 323)], [(294, 323), (293.413522613919, 292.1976141304737), (289.408643961169, 265.7552409641556), (299, 238)], [(299, 238), (317.5034462173368, 209.67371895612268), (322.6758121028119, 180.3687493473667), (358, 154)], [(358, 154), (316.4987058633153, 173.12003210293636), (310.6819720186201, 223.9214437896964), (279, 265)], [(279, 265), (274.4215887907716, 283.7294569772203), (263.1177457936506, 303.91208080975537), (255, 322)], [(255, 322), (251.6666666666667, 325.98579857985794), (248.3333333333332, 324.86458645864576), (245, 325)], [(245, 325), (243.14456314340583, 321.508505919753), (250.44357285852328, 317.44977717646105), (245, 315)], [(245, 315), (242.2589567789206, 317.7582894016651), (241.45608153525572, 324.53481404661085), (239, 327)], [(239, 327), (231.45712851658448, 328.73488547714305), (223.82476132405793, 330.1308196745275), (215, 333)], [(215, 333), (219.83302112426767, 338.96478370667216), (232.09803412185613, 328.8193499678725), (238, 332)], [(238, 332), (230.035235410792, 347.51933389309073), (232.606804110251, 365.1498826818198), (229, 383)], [(229, 383), (227.19164603864056, 386.35589183130156), (223.95043046409168, 386.9883704637805), (221, 388)], [(221, 388), (220.2880773968805, 383.43461633180834), (228.36094283067948, 378.55937861130155), (221, 378)], [(221, 378), (209.06833950196696, 402.4605506711314), (208.75683293833396, 429.4212898462356), (207, 458)], [(207, 458), (198.5953401056084, 454.99948047086684), (204.030199559799, 439.93771596734143), (195, 436)], [(195, 436), (196.79610335091607, 449.9561258202818), (204.95874203429062, 465.04968627692153), (207, 480)], [(207, 480), (196.0904174810356, 473.326272190045), (191.26119713919155, 462.9096423211933), (183, 450)], [(183, 450), (175.25454750392112, 433.3060330849263), (175.1882165320637, 411.12529358070026), (166, 397)], [(166, 397), (168.65853810213366, 437.21956834228695), (187.72395746721497, 475.7057636126539), (213, 494)], [(213, 494), (223.48655201211525, 535.2296308516875), (232.3180116825192, 574.3950462463779), (253, 607)], [(253, 607), (251.3718558436712, 612.1193607116403), (240.12528400278376, 616.4831532127914), (233, 614)], [(233, 614), (218.48844816852997, 601.7765428905228), (212.21606589141913, 590.3925532349011), (201, 579)], [(201, 579), (181.954568633552, 551.9907166836632), (176.98466974224567, 517.0525321059481), (165, 490)], [(165, 490), (168.1092963452243, 517.8661940004599), (181.8601624776463, 539.3054354106253), (180, 572)], [(180, 572), (172.4324832875276, 556.2327275329963), (169.69344568003837, 544.3726044620155), (166, 528)], [(166, 528), (164.61108084671824, 499.50189925725203), (159.57369771265772, 475.27974493074305), (160, 448)], [(160, 448), (167.2217484438888, 452.81014404974866), (170.01304474345912, 469.19359095686764), (178, 467)], [(178, 467), (165.84660618181465, 450.7159099426037), (161.29671431742125, 439.9131505455119), (152, 427)], [(152, 427), (146.78096558307968, 414.96967511583176), (150.45299327053237, 389.88201113105254), (140, 382)], [(140, 382), (153.09034292629565, 438.3177833139376), (160.71287675209422, 497.090531931889), (154, 561)], [(154, 561), (124.77002932373279, 657.1463127808403), (62.70224008140368, 750.960259670599), (61, 861)], [(61, 861), (67.92899096922942, 833.8575094551862), (70.44582802507405, 792.4736614815564), (79, 765)], [(79, 765), (91.65090415183818, 722.4451848565668), (113.62204226573616, 682.0067126759751), (129, 636)], [(129, 636), (131.11172336055128, 676.8923136134832), (118.06119515633353, 728.8658819317181), (121, 775)], [(121, 775), (124.508270449391, 802.6459145712515), (135.64152388302472, 831.8419317705842), (133, 861)], [(133, 861), (146.9419356756317, 854.6158765534174), (153.57014911740714, 844.2223198139208), (174, 828)], [(174, 828), (174.83760683760676, 826.0598290598285), (172.72649572649573, 825.3376068376073), (171, 825)], [(171, 825), (163.73942418426847, 835.324749779653), (145.14932130560106, 845.238544697172), (137, 854)], [(137, 854), (139.38553193559014, 789.4126502032373), (144.96103422600052, 724.6188795021803), (158, 667)], [(158, 667), (174.86531621169982, 633.9022845654488), (227.63892648616707, 621.0618005009558), (266, 611)], [(266, 611), (239.52870163002927, 643.1013152828497), (219.90045726773064, 696.2992037610693), (192, 730)], [(192, 730), (188.5618837256414, 725.0848034864762), (194.39677526242937, 711.4752541029933), (188, 713)], [(188, 713), (187.94813562730616, 723.7887981941776), (187.8784676981095, 730.6675981410785), (187, 740)], [(187, 740), (172.52227467899797, 772.1432869863198), (163.55964884562883, 794.8604186299586), (144, 826)], [(144, 826), (150.16700902301366, 824.4352125638266), (149.69302780939887, 817.4014970739884), (156, 816)], [(156, 816), (172.35654007446422, 819.1079707196315), (192.98818141094694, 823.5498996858252), (209, 827)], [(209, 827), (219.08003029252984, 841.7667408742604), (230.16850445220456, 850.154521763129), (242, 861)], [(242, 861), (245.03946569520355, 860.3727990285372), (250.61353976927737, 862.2802064359438), (252, 860)], [(252, 860), (243.3604559128425, 850.2668951812501), (231.98362414221012, 845.3741458813163), (223, 829)], [(223, 829), (239.59778807009042, 828.4726193708973), (254.54847969533483, 832.6647502582668), (269, 833)], [(269, 833), (284.1529529956398, 837.6256189886315), (285.57870723602053, 852.3420304790181), (296, 861)], [(296, 861), (297.4530872335748, 860.4530872335749), (301.16853438804674, 862.1685343880465), (301, 860)], [(301, 860), (295.7387510963227, 855.4564965753127), (289.59631473874316, 850.7531361343202), (286, 841)], [(286, 841), (293.9999999999999, 843.1308721973942), (302.00000000000017, 853.4582318640934), (310, 861)], [(310, 861), (312.99999999999994, 861.0000000000001), (316.00000000000006, 861.0000000000001), (319, 861)], [(319, 861), (352.9601965615202, 825.3366081577669), (391.9865005454703, 803.1264299356203), (418, 755)], [(418, 755), (450.62224565528766, 729.6168241559735), (480.22317358969093, 683.563867782992), (494, 644)], [(494, 644), (491.52830763532324, 641.0426926282296), (495.2268661249266, 635.0235575344673), (490, 635)], [(490, 635), (483.91582680355066, 640.4329630267667), (467.4760506932765, 651.9454773554365), (455, 650)], [(455, 650), (473.44439015959694, 632.1080120546436), (482.0033116917402, 598.8624152087735), (495, 575)], [(495, 575), (498.50108539546363, 562.5671547268289), (502.06949348274367, 550.7241344356304), (499, 539)], [(499, 539), (511.7783230704324, 532.7903889269809), (532.3978442164928, 523.9689924817586), (549, 510)], [(549, 510), (560.5133033969502, 498.83710931847946), (569.1608507736453, 482.7356923361726), (578, 472)], [(578, 472), (577.72628814916, 482.07008030571245), (567.2955876406352, 495.82054504218814), (565, 505)], [(565, 505), (570.0489297957532, 504.7026582260253), (573.0516449168905, 501.76573257857245), (576, 498)], [(576, 498), (574.6565924878962, 524.7662118910487), (561.1083595737554, 551.025694857799), (555, 576)], [(555, 576), (549.713576826127, 584.9287793015021), (545.3302712961497, 595.4103693256505), (539, 606)], [(539, 606), (536.3962720480306, 591.0660824213791), (554.9211475583868, 577.2744843956465), (549, 564)], [(549, 564), (545.5083689286422, 572.7548867884651), (544.9346270776873, 575.9919295780483), (542, 585)], [(542, 585), (531.3000451430065, 587.2796598602165), (517.7589213324857, 608.1286591843055), (509, 614)], [(509, 614), (510.3728706203955, 616.272460579391), (515.1270793746038, 611.1276794346102), (517, 612)], [(517, 612), (514.7172732244854, 622.78281207834), (511.9507231626892, 627.3467980375715), (505, 635)], [(505, 635), (508.89752203749913, 637.5673787578602), (516.499239096104, 623.9761792321374), (522, 626)], [(522, 626), (543.5835223478357, 638.8133804801158), (575.0846999887137, 648.4243383606969), (599, 659)], [(599, 659), (597.4460674380566, 681.4189561200272), (589.1191936697703, 702.8462155901507), (583, 724)], [(583, 724), (553.6052644623809, 771.0885052725597), (537.8201389357977, 815.5577472531049), (502, 861)], [(502, 861), (515.0040671829505, 857.7004621149241), (519.0131332998013, 839.2456991564611), (529, 828)], [(529, 828), (525.9086272109084, 839.3557970074783), (522.1217345015197, 849.1856823479405), (518, 860)], [(518, 860), (517.5598290598286, 862.1068376068367), (520.8376068376072, 860.4957264957271), (522, 861)], [(522, 861), (531.3380502203339, 826.7134871381793), (544.774936280772, 810.5977118120446), (555, 780)], [(555, 780), (578.0691613248687, 739.5106590067845), (598.6214421457182, 694.4916885307849), (633, 675)], [(633, 675), (648.4739793584453, 678.9034488115849), (653.7113360720747, 683.7928017622231), (669, 696)], [(669, 696), (648.45134784479, 710.4181397313637), (642.9725445760097, 733.0804749180339), (621, 759)], [(621, 759), (609.7624624284531, 792.5037272305303), (579.676843633158, 819.5940303512033), (568, 861)], [(568, 861), (595.5240731252151, 813.1758927257652), (628.1456258699249, 752.7734368083703), (661, 707)], [(661, 707), (667.3828803625037, 709.3500702961588), (673.7592102412484, 714.9651177107224), (676, 722)], [(676, 722), (668.9132696879278, 755.858550193819), (669.2171026313839, 798.7955699652947), (662, 833)], [(662, 833), (664.1772229631906, 841.489443703476), (657.3457200785565, 858.9876132547769), (666, 861)], [(666, 861), (666.9944931740905, 759.913839690594), (692.3470072981412, 674.6595459546626), (696, 579)], [(696, 579), (694.1713570686717, 454.9454110713691), (619.4685806447508, 315.8431772749014), (695, 212)], [(695, 212), (777.1036226317697, 235.61933916142732), (765.1359689336114, 347.90597423450424), (778, 424)], [(778, 424), (786.7252463375908, 525.175463323445), (748.6688959768692, 603.4422329127871), (757, 697)], [(757, 697), (751.0297431042903, 693.7033538608754), (752.4013005591814, 679.8681624822065), (745, 678)], [(745, 678), (738.1255588341227, 704.6601443036848), (733.9964243850358, 729.3032438286104), (732, 756)], [(732, 756), (736.8360754067144, 788.2934365858166), (733.4802127557142, 824.1349279738513), (739, 859)], [(739, 859), (740.5700787895905, 859.4299212104089), (739.85463163512, 862.1453683648807), (743, 861)], [(743, 861), (739.0689546250599, 843.5474123927788), (737.0991068302957, 814.2473921976646), (740, 797)], [(740, 797), (749.0298047855608, 820.8363721837967), (764.1525866241614, 833.8214986087662), (767, 861)], [(767, 861), (772.743548922034, 854.8527740262773), (763.424339718918, 826.3251598686506), (773, 818)], [(773, 818), (777.214435541686, 831.3709178915967), (771.8289395452775, 849.889397399121), (778, 861)], [(778, 861), (778.5178409612229, 760.5779097308002), (736.3561121718166, 665.9595082744657), (774, 567)], [(774, 567), (798.03213333949, 461.6316925347206), (754.6893907431697, 342.72188134944116), (779, 259)], [(779, 259), (777.3474215929199, 251.65257840707997), (773.306650362522, 246.69334963747826), (769, 242)], [(769, 242), (778.5716668375861, 245.25544816977884), (782.6813908836069, 253.4331434903313), (786, 264)], [(786, 264), (787.9458159926446, 278.58755193780684), (774.3739139207236, 285.50874781871886), (772, 297)], [(772, 297), (778.6236555771578, 293.0784701970359), (786.396716791973, 279.13540594975296), (789, 273)], [(789, 273), (790.8007377627481, 266.96562785055005), (786.8692789248563, 261.08437871199095), (786, 254)], [(786, 254), (775.7984478598934, 236.19259959107987), (763.8326728810855, 236.10459933647186), (749, 225)], [(749, 225), (726.0250723944196, 223.08976592265174), (715.5843368848524, 212.52289100023773), (695, 209)], [(695, 209), (663.6038201093468, 149.13776898027507), (620.1827045226624, 98.71362322839975), (559, 70)], [(559, 70), (517.1592776579282, 45.59533584303181), (464.8608857067494, 47.60650742457775), (413, 47)], [(222, 837), (225.8461538461536, 836.8931623931625), (221.67948717948735, 839.6709401709398), (222, 837)], [(220, 835), (224.21728395061731, 834.3993827160492), (219.9827160493827, 838.6339506172844), (220, 835)], [(218, 831), (221.9366495018669, 831.2831307179133), (217.8142662490489, 835.4055139707314), (218, 831)], [(216, 829), (220.21728395061714, 828.3993827160494), (215.98271604938282, 832.6339506172839), (216, 829)], [(179, 800), (221.52988366774022, 803.4353170589385), (260.2354406930154, 810.8806809019068), (302, 820)], [(302, 820), (307.91937984450806, 823.1312299268591), (311.0923696023524, 825.1119225870648), (315, 829)], [(315, 829), (315.00000000000006, 838.3333333333333), (314.9999999999999, 847.6666666666669), (315, 857)], [(315, 857), (305.49136958397355, 851.7432015468901), (290.39776144011125, 832.8768891146428), (274, 830)], [(274, 830), (243.1365786914505, 826.4165952608233), (205.80471849421295, 821.7739328513929), (174, 815)], [(174, 815), (168.82799433045392, 809.6070216785977), (178.34539110763745, 803.2463308512255), (179, 800)], [(166, 796), (169.31994971447304, 797.0133836188595), (174.55680098580706, 796.1098656808604), (175, 800)], [(175, 800), (170.9229142171506, 805.1437656052638), (170.87143382237895, 815.5410863722822), (162, 814)], [(162, 814), (161.59476915998655, 812.540585018846), (156.1390525738352, 813.0381695599086), (158, 809)], [(158, 809), (161.73284605081574, 807.091668060109), (161.5058298243926, 800.6329806657781), (166, 796)], [(345, 727), (373.6309878441625, 727.8353372026678), (397.70404009960924, 737.9740045739521), (412, 760)], [(412, 760), (401.7763377987566, 774.3558532753503), (390.4660375177773, 783.1400788819091), (385, 796)], [(385, 796), (356.7463958394611, 822.2520429282293), (344.21950260537807, 835.3911533931116), (319, 851)], [(319, 851), (319.6090470690162, 812.2344260364439), (325.89298164983364, 772.1472181782548), (326, 731)], [(326, 731), (332.0881774222321, 728.1592076765664), (338.3210987938571, 727.8084771113782), (345, 727)], [(671, 699), (671.4306949089557, 695.4828440480612), (675.9282794500186, 701.5086089433918), (678, 701)], [(678, 701), (678.4469838577678, 705.7721994120972), (677.2892109818755, 707.4361439686602), (676, 712)], [(676, 712), (671.5292565436212, 710.573586633097), (668.3818596538306, 707.90691996643), (665, 704)], [(665, 704), (665.8033803380341, 701.428242824282), (669.1165116511647, 699.7615761576161), (671, 699)], [(747, 688), (756.5566915772803, 700.5438879948872), (756.3041734912166, 722.5964891869955), (765, 738)], [(765, 738), (766.3123370842095, 768.1134132219355), (769.6018029749318, 803.9390867685895), (765, 835)], [(765, 835), (752.8586364824554, 815.4935923007095), (752.1651653076539, 799.9527870832168), (737, 783)], [(737, 783), (734.0877318654304, 751.3063604442707), (737.5331135768911, 716.6841936413382), (747, 688)], [(603, 662), (608.2215678023608, 662.9541639445828), (616.1776506262695, 665.3724506173259), (618, 671)], [(618, 671), (616.3579907573181, 685.336337974686), (602.7821677006726, 697.30276803844), (593, 709)], [(593, 709), (593.7068471103053, 690.3084210356759), (601.3894541602381, 679.8739316599143), (603, 662)], [(691, 614), (693.0436710337701, 613.3291995866251), (693.0066339967327, 618.1204453778713), (692, 621)], [(692, 621), (689.7913580246914, 618.6666666666665), (691.5753086419752, 616.3333333333334), (691, 614)], [(691, 609), (693.9310699588477, 606.7516460905351), (690.4022633744855, 614.5150205761315), (691, 609)], [(281, 606), (284.47810636140184, 603.2665523642552), (287.1865277849397, 605.4224720259889), (286, 609)], [(286, 609), (266.1154202582596, 643.2026485120106), (234.01700331830747, 693.7588853771541), (213, 727)], [(213, 727), (203.23752258794534, 751.7978652586571), (189.37384517661474, 772.6445323745313), (178, 795)], [(178, 795), (175.00000000000003, 795.6577158424861), (171.99999999999997, 792.8361865965385), (169, 793)], [(169, 793), (173.5801801459047, 775.4128921404174), (184.79565804103183, 756.3512576619383), (191, 738)], [(191, 738), (226.5004345924178, 699.9967465550137), (240.39012158761167, 634.1198156480214), (281, 606)], [(142, 604), (142.54283315463573, 637.1236083991569), (140.59752679967448, 678.8084172405103), (146, 712)], [(146, 712), (141.84075641360755, 747.4548938078511), (136.50345989976586, 783.1701871409736), (134, 820)], [(134, 820), (124.2774787616228, 794.3075810128585), (125.18833876332613, 767.7330530786589), (123, 743)], [(123, 743), (133.94086323249402, 699.7325220291456), (126.18418257826725, 639.3669227559315), (142, 604)], [(304, 598), (320.8356180731198, 603.0351356380248), (327.16076340858075, 609.7397239374495), (344, 620)], [(344, 620), (348.66634690386536, 618.3330135705324), (354.167293366239, 617.500626699572), (360, 617)], [(360, 617), (357.77189537760154, 642.8838260951459), (339.98680151685244, 659.0514872492795), (336, 684)], [(336, 684), (333.29657912790645, 697.9894789399299), (331.95543956425587, 711.5493547876038), (331, 725)], [(331, 725), (327.7184800850618, 728.0069164038144), (323.44115338491656, 725.8078894799571), (322, 729)], [(322, 729), (322.3777744723947, 760.1945294036223), (320.0602544369971, 793.3969329282073), (317, 823)], [(317, 823), (296.27023820899376, 812.1610475610014), (268.6169959122198, 812.2902696121597), (246, 804)], [(246, 804), (224.23117485713075, 801.2433770210408), (204.53667785263067, 800.0495154524717), (184, 797)], [(184, 797), (199.57346186683446, 751.8860468155232), (234.57573922886664, 703.9685055210288), (257, 660)], [(257, 660), (277.96168324362213, 643.9404130060476), (278.6301321945494, 608.8446834781502), (304, 598)], [(537, 591), (535.8215459049133, 600.3764401812098), (527.5837690971629, 608.7604344816319), (520, 619)], [(520, 619), (518.446382022844, 607.3230434698638), (526.9789067246488, 602.4908440742263), (537, 591)], [(148, 588), (153.52500279905868, 614.6220787618686), (142.36247546290633, 649.7871732684131), (151, 676)], [(151, 676), (148.89039288835116, 679.557059555018), (150.67426228406262, 687.0075956173961), (146, 688)], [(146, 688), (146.67539253276857, 652.4904697473801), (143.05100635537056, 620.8824037508733), (148, 588)], [(539, 587), (542.3634558861446, 589.0402335894394), (535.8560563089773, 590.6670834837313), (539, 587)], [(472, 582), (475.1124159016738, 586.4205079831104), (479.7381540206003, 602.2734188989431), (476, 612)], [(476, 612), (468.5812944903191, 625.040145760765), (455.79437704048604, 645.4451860491283), (447, 655)], [(447, 655), (465.15975626111424, 655.4924888316848), (473.07035103079863, 649.6484995801104), (490, 641)], [(490, 641), (487.9553654703856, 664.3512331785288), (470.7920971137488, 681.1702514301236), (463, 699)], [(463, 699), (445.6681999664144, 701.6219815232555), (421.6785825747232, 694.5509727309625), (405, 707)], [(405, 707), (420.1214021461816, 702.7669612781237), (440.04956674074907, 703.6732788628763), (458, 702)], [(458, 702), (452.92864972275333, 718.5994667359719), (430.5377020089945, 741.8468322091464), (414, 754)], [(414, 754), (405.85927873270356, 742.6941970156477), (388.88397227246577, 734.1793827079885), (372, 727)], [(372, 727), (361.73369789226564, 724.4375648403026), (346.3158720396574, 721.2597281407277), (336, 724)], [(336, 724), (333.9305314511608, 709.4099217830535), (337.73719842228155, 696.1649275737531), (340, 683)], [(340, 683), (345.59848615452455, 666.8098339238835), (350.2440773880268, 647.3820013132705), (361, 634)], [(361, 634), (370.0646759187591, 639.3719395477862), (362.3654118314034, 659.3727853133381), (371, 662)], [(371, 662), (373.06853915749207, 645.4977572292577), (362.4691128535132, 634.3051943108914), (364, 617)], [(364, 617), (373.18211560647774, 614.9509125263831), (381.842033245462, 613.4762450349787), (392, 613)], [(392, 613), (415.2789969576139, 602.6507529758723), (446.3696230646623, 592.132766218714), (472, 582)], [(344, 682), (350.17686485438503, 690.0713146822288), (359.20715785445526, 694.8910577939738), (369, 701)], [(369, 701), (363.28902257680653, 691.2529327036622), (352.45489195122525, 685.1301223416907), (344, 682)], [(491, 569), (493.7239989214815, 572.0882289131622), (485.0047188833609, 588.1736510130777), (480, 596)], [(480, 596), (478.27905647916845, 589.972130311337), (477.55014094879044, 585.7051738086914), (478, 579)], [(478, 579), (483.8568654891539, 573.770794828691), (487.2256475265523, 572.2016924993546), (491, 569)], [(236, 553), (253.4964075569541, 564.6615310280018), (279.5654991350427, 581.7199641309908), (299, 596)], [(299, 596), (285.098024981502, 601.9436978165044), (272.99108825746555, 603.3585572487191), (255, 609)], [(255, 609), (248.52024864021635, 590.4074819414337), (234.90740997131488, 577.9922417463814), (236, 553)], [(687, 541), (698.8730672053, 561.1850829325248), (679.0964728158096, 607.9780061607111), (691, 627)], [(691, 627), (680.2942403070952, 649.238175327323), (687.467887911464, 680.044446234371), (677, 696)], [(677, 696), (662.7570709025191, 682.8604559201638), (653.3343839529738, 684.431953495453), (646, 673)], [(646, 673), (653.8262116723373, 652.2302946172597), (662.9140023469117, 635.9917997643819), (673, 615)], [(673, 615), (678.9801873747595, 590.0285416128104), (680.1573126041832, 569.0192318990983), (687, 541)], [(160, 508), (163.46120185789368, 521.8803720068863), (164.44195101762122, 541.3396961325864), (170, 559)], [(170, 559), (179.2777266304836, 575.0605886782756), (186.73151497756476, 607.7865838684622), (205, 611)], [(205, 611), (191.1250689556696, 593.8361976508864), (182.5635513952871, 575.7910115694406), (183, 553)], [(183, 553), (193.34264675249685, 575.7215390692517), (210.64679402912938, 599.6258745773972), (232, 617)], [(232, 617), (211.97190287971668, 618.923826122261), (189.31110885362608, 633.816352654829), (173, 643)], [(173, 643), (163.6293764112228, 649.7885683764823), (158.29097438345337, 657.9941794556104), (153, 669)], [(153, 669), (147.49104034523887, 613.8401556719083), (158.84851397303802, 564.6498200552803), (160, 508)], [(210, 460), (212.26952695269532, 461.06380638063786), (210.38063806380632, 466.28602860286026), (211, 469)], [(211, 469), (208.74465872565688, 466.0000000000001), (210.6089998109285, 463.0), (210, 460)], [(673, 452), (690.6927480385682, 492.6536820965341), (684.3116216860554, 545.396010006626), (674, 598)], [(674, 598), (667.5618044137451, 623.9377429096132), (650.2822508219672, 649.3138830201191), (643, 673)], [(643, 673), (635.6906331210348, 668.7961384315659), (629.1514260725755, 674.266775294568), (621, 676)], [(621, 676), (620.3176963030741, 670.8481230448043), (623.5723206173998, 667.6190121888284), (620, 665)], [(620, 665), (611.9593271731601, 661.5542002357531), (602.6419888986517, 657.5029296786546), (597, 653)], [(597, 653), (624.5812936760196, 617.525093584448), (636.4840765632235, 574.7429693349877), (654, 535)], [(654, 535), (668.1872466787005, 510.7770990614509), (659.5410240413561, 471.34636821954905), (673, 452)], [(431, 416), (441.6666666666666, 415.62449199215723), (452.3333333333334, 416.2890811904954), (463, 417)], [(463, 417), (466.7328399506617, 420.29152915291513), (468.8675200853417, 421.978397839784), (469, 426)], [(469, 426), (453.3673511311262, 422.9414158293678), (441.50783613066943, 419.84403517974465), (428, 423)], [(428, 423), (428.5574949724129, 420.7774669554302), (431.86933429587987, 419.10058182505753), (431, 416)], [(427, 412), (431.1532159337036, 411.043695263207), (427.2019964215086, 414.99491477540306), (427, 412)], [(439, 408), (446.61217548021256, 409.1526563760284), (457.3747172862328, 405.28604682705185), (460, 413)], [(460, 413), (450.0, 412.9999999999999), (440.0, 413.0000000000001), (430, 413)], [(430, 413), (429.735513179903, 408.0688465132361), (436.27971524649286, 409.9463819131598), (439, 408)], [(666, 405), (670.2042175805997, 413.86567334347444), (672.5132920867946, 430.5768000804949), (672, 438)], [(672, 438), (666.4879169339627, 434.3080183505667), (662.6160807722715, 421.29518063362264), (658, 418)], [(658, 418), (657.7138109498143, 411.4545686659701), (664.1861759251035, 409.07291588080824), (666, 405)], [(623, 403), (637.1070256939257, 420.78328002550126), (654.8665682528937, 430.3051230350704), (673, 445)], [(673, 445), (655.3013155602348, 476.53222434816513), (636.1241118984952, 497.82308625754877), (615, 518)], [(615, 518), (599.8794551301854, 529.9111487234917), (586.1788056948947, 536.6398097261477), (572, 542)], [(572, 542), (582.8180827849465, 544.2752955854227), (595.3432369763734, 534.5506082404812), (604, 531)], [(604, 531), (625.1734594571067, 511.93495287064917), (643.116591909597, 497.38168950203675), (662, 470)], [(662, 470), (665.3954136721019, 511.4067223355018), (645.5267679565981, 536.7670676602395), (637, 571)], [(637, 571), (621.3634379694655, 599.1241278263429), (613.0377056987156, 635.6356050063146), (590, 652)], [(590, 652), (569.287837172054, 641.575575080857), (539.3303221734693, 634.6410442693299), (522, 621)], [(522, 621), (527.3850644965988, 616.628532857365), (530.406028864866, 609.4759204619023), (534, 606)], [(534, 606), (537.3932325281203, 608.4410330485381), (534.3028459032523, 612.5197512651874), (534, 617)], [(534, 617), (545.0436198816368, 609.4783032621887), (549.5620565109363, 588.2190669538023), (559, 576)], [(559, 576), (565.3890731090614, 549.5874284623682), (577.2176358640323, 521.1636655374635), (582, 496)], [(582, 496), (605.982282934259, 478.82433507373105), (627.477111033091, 453.0733201342061), (645, 430)], [(645, 430), (627.6421706000755, 439.21957933399125), (611.1000834555839, 474.510981944459), (587, 486)], [(587, 486), (603.865674748995, 459.16907475841964), (611.6618653062803, 433.9353652826248), (623, 403)], [(254, 391), (271.99019879548734, 391.47987366039655), (284.4790754275408, 396.9683303399104), (299, 409)], [(299, 409), (299.1504563048601, 429.0459055689058), (300.68287106372895, 446.86498689382233), (291, 464)], [(291, 464), (279.5937900839158, 463.34109177411705), (269.17341175094657, 460.58288286160865), (260, 464)], [(260, 464), (242.43059715119404, 442.4451323860268), (241.05526279692845, 413.2775610035302), (254, 391)], [(232, 389), (234.55486542443066, 386.8758294845251), (233.98481711525193, 391.9434623347667), (234, 394)], [(234, 394), (227.57161449131996, 394.9438708689611), (226.85248499410034, 401.6666208405873), (220, 406)], [(220, 406), (220.07088599127462, 401.9291140087248), (216.7369268855038, 401.2630731144969), (218, 396)], [(218, 396), (224.4386476412797, 384.668346872457), (230.00605939958695, 396.0741335695803), (232, 389)], [(244, 381), (265.7594495078921, 380.80374114695053), (283.62049939623586, 387.71713391370383), (299, 402)], [(299, 402), (285.1300267266416, 395.2166855832537), (260.2525750829813, 381.3749464907532), (236, 391)], [(236, 391), (234.49687851285174, 385.5504409254746), (238.0363073278561, 380.7250015524014), (244, 381)], [(491, 379), (495.9312651564077, 390.39439040520733), (499.4278432217629, 410.06579406827467), (500, 425)], [(500, 425), (496.07634704902466, 424.2213503962137), (493.639499945511, 422.83056217209236), (492, 421)], [(492, 421), (492.9797007504878, 408.0905047419386), (491.2713283611792, 393.49852170866995), (491, 379)], [(494, 372), (515.5732687442189, 378.42462148089646), (519.1727719438144, 387.6494195306998), (537, 400)], [(537, 400), (534.3616919433375, 417.42920365388227), (528.1386784656414, 433.86968510374794), (525, 453)], [(525, 453), (500.4570788431933, 431.6236958019513), (500.8560524136594, 399.69820549551434), (494, 372)], [(657, 362), (662.4435078086494, 372.17000617596347), (660.7781953791655, 384.5050263816493), (666, 398)], [(666, 398), (662.8212041161164, 398.9523302699337), (660.7315539520914, 406.03592028320577), (656, 409)], [(656, 409), (650.5856833902545, 394.7067572335285), (653.7262541725668, 376.96900105890927), (657, 362)], [(450, 358), (462.56837646515356, 356.66840746762847), (475.1482313643413, 362.15231724992907), (486, 367)], [(486, 367), (489.47653818264797, 389.3053205100328), (487.84735192484186, 416.6686198282688), (488, 439)], [(488, 439), (480.5757128228726, 433.49367178498375), (472.30432201344655, 421.3894144429402), (464, 412)], [(464, 412), (462.57666619961725, 406.2827985614872), (469.03535565830623, 410.9822287609173), (472, 408)], [(472, 408), (468.75140173126107, 406.47398061542094), (463.2485982687389, 406.73493215322617), (460, 404)], [(460, 404), (455.65252162339596, 387.871825212914), (446.8676371798292, 369.56641405720404), (450, 358)], [(654, 333), (657.6521729212225, 343.5571952453824), (654.3271992891069, 363.89644973820776), (650, 375)], [(650, 375), (648.3149668079628, 364.8050259298609), (644.8276891018849, 355.066276413589), (645, 342)], [(645, 342), (649.9223808071445, 339.45364968726614), (653.0974031314211, 336.75993875474876), (654, 333)], [(648, 329), (652.8546643513079, 326.794523843818), (649.8516293549859, 334.0501831733028), (649, 336)], [(649, 336), (646.9999999999999, 336.01293279342036), (644.9999999999999, 338.72837994789234), (643, 338)], [(643, 338), (640.3777380829814, 335.55202608589235), (646.9887854104456, 332.9458263155133), (648, 329)], [(247, 329), (247.27181069958834, 326.64423868312747), (251.42818930041165, 328.3890946502059), (251, 330)], [(251, 330), (244.2690303044705, 342.34210724853193), (242.53806834611316, 348.49251258994303), (236, 360)], [(236, 360), (235.1541018966906, 346.87776548604853), (236.749331268713, 333.16566851529285), (247, 329)], [(294, 327), (296.6666666666666, 327.0151828847481), (299.3333333333334, 326.4451345755693), (302, 329)], [(302, 329), (299.4862825734925, 337.9111154348967), (300.78154280857365, 349.7932309399453), (295, 358)], [(295, 358), (292.87515941550544, 349.4581739178279), (294.51534197924457, 337.1513246874221), (294, 327)], [(440, 286), (439.6204886386688, 305.01427855357014), (438.42552970613, 330.43580708553986), (444, 352)], [(444, 352), (438.1310364338686, 354.44407516818393), (431.23586044634084, 351.584360173564), (430, 357)], [(430, 357), (433.2865899603626, 360.7921322690214), (440.12647176238096, 354.86217458990893), (445, 358)], [(445, 358), (445.2821559729114, 375.07151380287434), (454.3446297232692, 390.9151131196956), (456, 405)], [(456, 405), (441.24149920237966, 403.6088913954732), (428.1609929001125, 406.48538729880556), (416, 413)], [(416, 413), (415.1219231654013, 414.7680274636796), (412.83045778697965, 415.9193962237441), (415, 418)], [(415, 418), (418.7994060166709, 417.21666361801823), (425.2794767334827, 408.96872619168107), (428, 416)], [(428, 416), (424.4989552135356, 425.01082245488215), (415.6500832480028, 423.861015729456), (412, 435)], [(412, 435), (419.9406151341798, 434.71636957686667), (428.2416557078166, 421.5031017897115), (441, 427)], [(441, 427), (426.0969083637951, 445.1507545470299), (435.7484500231546, 470.67749359388955), (432, 491)], [(432, 491), (445.64695992548155, 497.43223091395157), (450.93147744188326, 496.61511614031593), (464, 502)], [(464, 502), (461.365650112537, 493.4841207500496), (444.0514484487406, 494.17397053872793), (436, 489)], [(436, 489), (437.48017651787507, 466.2736863335436), (430.6029165261464, 445.1771870019307), (445, 426)], [(445, 426), (466.27279220128844, 425.07864303754326), (478.5545638854497, 432.52051165440747), (493, 448)], [(493, 448), (496.4092756059973, 446.11167157068815), (489.1699593666803, 443.9620989211152), (493, 440)], [(493, 440), (497.0764743140979, 440.7576757675764), (496.44347768110146, 443.1920192019205), (501, 447)], [(501, 447), (504.3346624310473, 472.9217918476733), (485.2055395548112, 487.30837475288195), (472, 502)], [(472, 502), (469.6666666666667, 502.0), (467.3333333333333, 502.00000000000017), (465, 502)], [(465, 502), (463.4452396647515, 505.1453683648805), (468.39645917694725, 504.4299212104091), (468, 506)], [(468, 506), (487.32448399861374, 495.1250162340415), (501.4634866597743, 478.94409047138174), (505, 454)], [(505, 454), (510.2045573795949, 457.27598558000875), (509.16997037861734, 465.34948666177894), (515, 468)], [(515, 468), (512.6025775439933, 453.10162784942537), (503.10112779931546, 442.82190959065804), (492, 435)], [(492, 435), (493.76482493422395, 433.3882505877043), (490.36359036632257, 429.9860663521864), (493, 426)], [(493, 426), (506.3334010834417, 437.5117496787346), (508.81524165971155, 436.9395533424642), (519, 449)], [(519, 449), (523.1509984802259, 473.8246934687097), (499.479806745699, 501.0686403487124), (492, 526)], [(492, 526), (484.3286513475175, 539.8132856307578), (470.97292726366953, 549.0790757971907), (457, 558)], [(457, 558), (457.1246913580247, 561.3600823045267), (461.2419753086419, 559.55658436214), (463, 560)], [(463, 560), (471.43253997767937, 552.1426706119345), (484.76576810809667, 546.4500977663198), (496, 539)], [(496, 539), (498.6366002616799, 544.9289046924621), (496.00991203105883, 553.4628906191446), (496, 560)], [(496, 560), (471.45378634491965, 585.8923316553437), (432.1747754201451, 589.6284210764228), (405, 605)], [(405, 605), (384.50114733574634, 611.399973144699), (362.5893650845259, 612.9865143941051), (342, 616)], [(342, 616), (322.3730105540726, 599.1623594260174), (294.75792367778365, 589.4013731425275), (274, 576)], [(274, 576), (259.5131733110946, 563.3701896143306), (242.74386684222, 554.796637049136), (228, 538)], [(228, 538), (221.12571829835292, 524.0030510448101), (219.82463854498775, 513.5795086905754), (216, 498)], [(216, 498), (219.3031241743424, 476.4749122166344), (207.96285763563228, 437.44727590315256), (216, 408)], [(216, 408), (220.99284491464653, 414.46866149524465), (219.42750897321073, 419.83750059307795), (226, 426)], [(226, 426), (229.2335083882434, 420.9762073235252), (220.61100004450037, 413.693270257717), (224, 408)], [(224, 408), (231.24264946280826, 398.0413497034605), (237.12453457266844, 393.7154774190629), (248, 393)], [(248, 393), (244.46015848661946, 405.6640212460375), (240.71460511680053, 418.1961225736781), (242, 432)], [(242, 432), (246.36270535122057, 445.86572117202724), (248.6548096913135, 450.1295758747948), (254, 463)], [(254, 463), (266.8581036918078, 466.68863236884414), (279.7010164673124, 466.3868210066094), (294, 467)], [(294, 467), (305.622740627537, 448.1838013825893), (299.76780414124704, 416.2875822282432), (303, 401)], [(303, 401), (294.377142187975, 388.9081276300057), (269.9600539579465, 381.69028675093205), (253, 376)], [(253, 376), (273.16277645074325, 369.1530707102863), (290.0780086707683, 391.20158079796295), (298, 386)], [(298, 386), (283.6027796548083, 375.3068778723079), (269.39777644091356, 369.0146952234924), (248, 371)], [(248, 371), (244.08959317654967, 374.7358744315265), (251.69184760489114, 373.8502061545541), (247, 377)], [(247, 377), (242.74250774524015, 378.81053352638065), (240.38590755530632, 377.1676085501221), (237, 380)], [(237, 380), (234.97630061412715, 360.68324870823403), (249.74703208057437, 343.7925844303333), (256, 327)], [(256, 327), (266.99999999999994, 325.03208447285914), (278.00000000000006, 326.40517942352506), (289, 326)], [(289, 326), (291.83962955699405, 345.3299767473414), (289.810548369551, 366.9603406155165), (299, 381)], [(299, 381), (298.44862665846154, 351.1633513675132), (306.1674435090215, 330.1057506686), (310, 312)], [(310, 312), (311.91332223160185, 331.73955921279975), (314.23144327197167, 349.55263252132397), (315, 371)], [(315, 371), (322.99534244324025, 397.5958347217946), (337.4595682171962, 417.4422286576352), (361, 440)], [(361, 440), (361.0419491152415, 430.0388825022762), (346.10939309993717, 419.5084048530336), (349, 404)], [(349, 404), (364.6536401051336, 426.628363728355), (375.7951834839339, 433.2299021360085), (391, 455)], [(391, 455), (400.5797840802385, 462.8371929388862), (408.8462252057589, 471.5394420194967), (419, 477)], [(419, 477), (413.35487494419, 453.15635869701146), (397.1483532365853, 426.6544157237005), (399, 397)], [(399, 397), (418.16085174951724, 359.9961186375515), (429.52111385765835, 322.8028648195034), (440, 286)], [(373, 556), (368.2940523948995, 562.4380455218687), (359.09666604533965, 560.2531562476079), (355, 566)], [(355, 566), (360.66666666666674, 566.8703907757903), (366.3333333333333, 564.0280766571601), (372, 562)], [(372, 562), (372.7986490867769, 561.08005301803), (380.01422769161724, 555.5657150070485), (373, 556)], [(322, 548), (320.5788673451112, 555.787206768136), (334.5816312249148, 565.9804331345404), (343, 564)], [(343, 564), (337.8848445254315, 558.5385692226138), (327.5973407477276, 557.2861112433969), (322, 548)], [(324, 491), (321.81378600823035, 493.3557613168724), (321.8528806584363, 493.9442386831277), (322, 497)], [(322, 497), (325.337721859461, 497.1642512077294), (326.21050768876853, 490.8357487922706), (324, 491)], [(627, 273), (635.8638655251374, 290.29607818813906), (633.461319993781, 310.8611440462144), (638, 328)], [(638, 328), (627.5953922488835, 321.9776708770374), (617.4972938505665, 307.4080265155008), (612, 294)], [(612, 294), (611.6909357602423, 290.35760242690924), (612.1589492282563, 287.4922825615895), (613, 285)], [(613, 285), (619.4358086782502, 277.53340342265585), (620.6341729055436, 278.2330176945941), (627, 273)], [(290, 254), (288.74365640558466, 269.0290689445156), (290.3026077050166, 300.40409053334866), (290, 322)], [(290, 322), (281.1164332370295, 323.7615325180918), (270.27324971515344, 319.37182680276754), (260, 324)], [(260, 324), (263.43252689152274, 309.0084685236534), (278.8297710436483, 276.2595958616795), (290, 254)], [(640, 253), (639.0675972765129, 257.08853771373305), (619.8210741596603, 274.2241093624805), (611, 281)], [(611, 281), (614.113405595275, 266.9456780952821), (627.9370773241512, 259.0013900494564), (640, 253)], [(644, 250), (649.6429051161749, 251.82129557551906), (636.9912882766394, 253.37571431114603), (644, 250)], [(648, 249), (650.5810699588473, 246.17551440329237), (647.0522633744861, 252.1744855967076), (648, 249)], [(672, 242), (669.483555550029, 261.95893708071145), (658.4379095031417, 288.136618126472), (654, 312)], [(654, 312), (648.080119366977, 317.96127737478093), (649.8338584217425, 325.49070577528204), (642, 330)], [(642, 330), (637.3961980765079, 313.1442279424619), (638.0346359300036, 293.9098667291146), (633, 277)], [(633, 277), (641.080313810465, 275.78478885803344), (654.2241740729819, 279.85169827702606), (659, 274)], [(659, 274), (649.9999999999997, 271.67575553979566), (641.0000000000005, 273.6598608985605), (632, 273)], [(632, 273), (629.8931623931621, 271.3333333333332), (631.5042735042737, 269.6666666666667), (631, 268)], [(631, 268), (637.9128616381867, 260.282716431054), (648.978664035628, 252.37769572712028), (662, 246)], [(662, 246), (665.0586419753088, 246.29423868312762), (664.9413580246912, 248.70576131687238), (668, 249)], [(668, 249), (666.9995999599955, 245.6395639563957), (667.0198019801983, 243.71027102710258), (672, 242)], [(766, 241), (766.6827160493829, 237.47551440329207), (770.9172839506172, 243.4744855967079), (766, 241)], [(665, 241), (667.5641025641021, 238.11538461538436), (667.5641025641028, 242.28205128205147), (665, 241)], [(670, 238), (676.664840406332, 236.01023565203934), (664.3778425204974, 241.36171556747288), (670, 238)], [(673, 236), (680.721605493883, 234.6832016534986), (669.7788445511214, 241.41720838750544), (673, 236)], [(755, 234), (757.1960784313726, 232.6928104575163), (757.1960784313725, 236.24836601307194), (755, 234)], [(737, 234), (749.5859809972827, 234.20577761253213), (765.7232899777067, 241.86944854486157), (773, 251)], [(773, 251), (779.9806614962973, 265.08738568288646), (772.7591770435413, 277.670435774935), (765, 287)], [(765, 287), (758.2629342584646, 270.5032957117156), (747.8313057050551, 247.40064521818246), (737, 234)], [(732, 226), (741.6285409965556, 222.67669285767656), (750.7103889722888, 230.2518686931121), (755, 233)], [(755, 233), (745.9060491944542, 233.92781354293834), (739.1930911742824, 229.19536256836125), (732, 226)], [(140, 177), (149.25863574436852, 184.90613029156728), (151.2108566386187, 193.50730337100126), (161, 204)], [(161, 204), (164.68185826268652, 197.9606451154204), (150.53152257658508, 190.11898388582378), (150, 182)], [(150, 182), (157.42925546878487, 186.785991364944), (167.8166769336008, 193.76511795741317), (170, 200)], [(170, 200), (146.12642946127824, 235.28768908982937), (127.56046904717229, 281.6207395503904), (99, 319)], [(99, 319), (96.5085861325005, 291.4942333431024), (101.76185591508359, 262.19965261487675), (108, 236)], [(108, 236), (116.96117836715999, 215.62591946937485), (127.2819308217903, 193.93380413498008), (140, 177)], [(152, 153), (154.9945453900576, 155.8690564791153), (145.08298009447662, 163.32593848960323), (144, 167)], [(144, 167), (141.242313894298, 160.09751695526592), (146.08935458663086, 156.54972643334904), (152, 153)], [(146, 151), (148.42336140307737, 153.00338505308082), (141.2727170282952, 153.99241326624693), (140, 159)], [(140, 159), (136.70360706954816, 155.50851535600478), (143.98665841717747, 152.66626340505712), (146, 151)], [(149, 150), (152.28395061728386, 147.1783950617285), (148.04938271604948, 152.47160493827147), (149, 150)], [(197, 146), (199.3910001890717, 146.60899981092837), (204.25534127434292, 144.74465872565702), (205, 147)], [(205, 147), (192.48783695951886, 162.0304124917132), (183.04375433664734, 177.78661604069595), (171, 196)], [(171, 196), (164.53181487679606, 186.31833155717382), (153.01575065332355, 180.55759347221962), (145, 171)], [(145, 171), (151.1626850517532, 161.28446863315426), (155.7130566138463, 155.9792655197462), (164, 149)], [(164, 149), (174.24197702087255, 145.9223058789591), (185.50598662596752, 147.46182684225232), (197, 146)], [(198, 139), (201.69528961009684, 137.71204803760594), (207.96157313500123, 136.42660742457895), (210, 140)], [(210, 140), (198.09860576618175, 146.38880029128302), (182.3235949957824, 141.2595649887332), (170, 144)], [(170, 144), (177.7345168490223, 140.46788986987647), (188.969788417783, 140.23745489796832), (198, 139)], [(188, 135), (191.61666666666665, 133.69938271604937), (191.6166666666667, 137.93395061728398), (188, 135)], [(270, 94), (276.3885615189963, 91.27061987931553), (268.14379501336026, 97.04195643326078), (270, 94)], [(276, 91), (279.8559660702315, 92.64460114474294), (270.2233022224514, 93.80052080647658), (276, 91)], [(316, 69), (315.8314656119532, 66.83146561195342), (319.5469127664251, 68.54691276642497), (321, 68)], [(321, 68), (308.8887462768607, 76.64305288072778), (294.7500032035258, 84.38709991099084), (277, 90)], [(277, 90), (288.54056994551064, 83.08702793607793), (302.1316379916229, 72.40087244201086), (316, 69)]]
    np.random.shuffle(all_beziers)
    
    return all_beziers

# 主程式執行
if __name__ == "__main__":
    # 創建測試數據
    bezier_array = create_test_bezier()
    
    print("步驟1: 分組貝茲曲線成閉合輪廓...")
    closed_contours = layer_categorize(bezier_array)
    print(f"找到 {len(closed_contours)} 個閉合輪廓")
    
    print("\n步驟2: 分析輪廓的內外子母關係...")
    hierarchy = categorize_contours(closed_contours)
    
    print("\n層級結構:")
    print_hierarchy(hierarchy)
    
    print("\n步驟3: 視覺化結果...")
    visualize_contours(hierarchy)

    print(hierarchy)